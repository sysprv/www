<!DOCTYPE html>
<html>
<!-- vim:set ts=8 sts=4 sw=4 et ai: -->
<head>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
<meta name='description' content='The personal home page of Ishan Oshadi Jayawardene' />
<meta name="google-site-verification" content="z1VFyoPywn7Z8cdkh_wkCYJU57c5viq1EKnCD4ATJuQ" />
<meta name='viewport' content='width=device-width' />
<title>Ishan Oshadi Jayawardene/SYSPRV</title>
<!-- Ropa Sans, Cuprum -->
<link href='http://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'>
<link rel='shortcut icon' href='favicon.ico' />
<style>
body {
  font-family: 'Droid Sans Mono', Verdana, Helvetica, sans-serif;
}

a img {
  border: 0px;
}
</style>
</head>
<body>
<p style='font-size: 120%;'>Ishan Oshadi Jayawardene</p>
<div
 id='rhs' style='width: 215px; float: right; padding: 0px 5px 0px 5px;'><a
 href='.plan'><img
 alt='Portrait of the system administrator at GOTO 2010'
 width='210' height='210'
 src='me-small.jpg' /></a>
<br/>
<!-- game of life glider - 210x80, 21 cells by 8 cells. -->
<table id='glider'>
<tbody id='tbd'></tbody>
</table>
</div>
<p><a href='EFFA17D4.txt'>i@tangotangolima.com</a></p>
<p id='about'>I'm a system administrator + developer
working in Hamar, Norway. I like to read.</p>
<br />
<div id='icons'>
<!-- The following icons (except for pinboard.in) are
from IconDock&amp;s free set:
http://icondock.com/free/vector-social-media-icons -->
<p><a rel='me'
 href='http://www.goodreads.com/user/show/357530-ishan-jayawardene'><img
 src='9e65dd5aea2facbb94ab8a335a40cfaeacf261ae378f40a5e18e0d471a495230.png' width='32' height='32' alt='Goodreads' /></a>
<a rel='me'
 href='https://github.com/sysprv'><img
 src='e643c59cc5767356d77d41cd9efdde2a98a29e640ae29c1a933dd98adad99380.png' width='32' height='32' alt='github' /></a>
<a rel='me'
 href='https://pinboard.in/u:sysprv'><img
 src='008d3546d7405492370d407153a407b55df8adda3831b1dd903470e51fa00dc4.png' width='32' height='32'
 alt='pinboard.in - bookmarks' /></a>
<!--
<a rel='me'
 href='http://www.linkedin.com/in/ishanoshadi'><img
 src='2d6a030ab982ce934b762eeea9854bdf13acfded656ae6a2e311556bac4cc39c.png' width='32' height='32' alt='LinkedIn' /></a>
<a rel='me'
 href='https://plus.google.com/103061928773228269382/about'><img
 src='f0407d93ca4b78a3992818b5b52192cb286a87aa0dd43c6ed166c575adc2683b.png' width='32' height='32' alt='Google+' /></a>
<a rel='me'
 href='https://graph.facebook.com/fast.cheap.good.heighliners'><img
 src='d6e2ddfb8973bca09f3ad4217f6f91c9d571fe31e893fcaa6a8f025bda5cb642.png' width='32' height='32' alt='Facebook' /></a>--></p>
</div>
<!-- see .plan -->
<p><a href='https://freedom-to-tinker.com/?s=aacs'>09-f9-11-02-9d-74-e3-5b-d8-41-56-c5-63-56-88-c0</a></p>
<p><a href='hdcp.html'>HDCP master key</a></p>
<p><a href='gosper.html'>The Gosper Gun</a></p>
<p><a href='edc.html'>Everyday carry (EDC)</a></p>
<br/>
<br/>
<div id='sysprv-definition' style="font-size: 67%; float: bottom;">
<hr/>
<blockquote>
The <a
href='http://h71000.www7.hp.com/doc/84final/ba554_90015/apas35.html'>SYSPRV</a>
privilege lets a process access protected objects 
by the system protection field and also read and modify the 
owner (UIC), the UIC-based protection code, and the ACL of an 
object. Even if an object is protected against system access, 
a process with SYSPRV privilege can change the object's 
protection to gain access to it. Any process with SYSPRV privilege 
can add, modify, or delete entries in the system 
user authorization file (SYSUAF.DAT).</blockquote>
-- <a href='http://h71000.www7.hp.com/doc/os84_index.html'>HP OpenVMS Systems Documentation</a>
</div>
<div id='math' style='position: fixed; right: 3px; bottom: 3px; font-size: 50%;'>&pi;</div>

<style type="text/css">
table {
    border-collapse: collapse;
    border-spacing: 0;
}

td {
    height: 10px;
    width: 10px;
    padding: 0;
}
</style>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script type="text/javascript">
(function gameOfLife() {
    var cellsz = 10, // width == height
        spacing = 0,
        cellcount_x,
        cellcount_y,
        universe_type,
        cells,
        neighbour_count = {},
        new_live = [],
        new_die = [],
        may_live = [],
        may_die = [];


    // el cheapo hash table; keys will be JS arrays.
    function neighbour_count_get(key) {
        var k = key.toString();
        if (neighbour_count.hasOwnProperty(k)) {
            return neighbour_count[k];
        }
        return 0;
    }

    function neighbour_count_put(key, val) {
        var k = key.toString();
        neighbour_count[k] = val;
        return val;
    }

    function create_structures() {
        var i, j;
        cellcount_x = 21;
        cellcount_y = 8;

        cells = new Array(cellcount_x);
        for (i = 0; i < cellcount_x; i++) {
            cells[i] = new Array(cellcount_y);
            for (j = 0; j < cellcount_y; j++) {
                cells[i][j] = {
                    state: 0
                };
            }
        }

        if (console && console.log) {
            console.log("x*y->" + cellcount_x + "*" + cellcount_y + "=" + cellcount_x * cellcount_y);
        }

        var tbd = document.getElementById("tbd");
        for (i = 0; i < cellcount_y; i++) {
            var tr = document.createElement("tr");
            tr.id = "y" + i;
            for (j = 0; j < cellcount_x; j++) {
                var td = document.createElement("td");
                td.id = "x" + j + "y" + i;
                td.style.backgroundColor = "black";
                // td.style.backgroundColor = "gray";
                // td.appendChild(document.createTextNode(" "));
                tr.appendChild(td);
            }
            tbd.appendChild(tr);
        }
    }

    function isdead(cell) {
        return cells[cell[0]][cell[1]].state === 0;
    }

    function islive(cell) {
        return cells[cell[0]][cell[1]].state === 1;
    }

    function setdead(cell) {
        cells[cell[0]][cell[1]].state = 0;
        document.getElementById("x" + cell[0] + "y" + cell[1]).style.backgroundColor = "black";
    }

    function setlive(cell) {
        cells[cell[0]][cell[1]].state = 1;
        document.getElementById("x" + cell[0] + "y" + cell[1]).style.backgroundColor = "red";
    }


    // set an unbounded topology - no wrapping around.
    function unbounded(x, y) {
        return [ x, y ];
    }

    // bounded topology - not possible to fall off the edge of the universe.
    function closed(x, y) {
        var _x, _y;
        if (x >= 0 && x < cellcount_x) {
            _x =x;
        } else if (x < 0) {
            _x = x + cellcount_x;
        } else if (x >= cellcount_x) {
            _x = cellcount_x - x;
        }

        if (y >= 0 && y < cellcount_y) {
            _y = y;
        } else if (y < 0) {
            _y = y + cellcount_y;
        } else if (y >= cellcount_y) {
            _y = cellcount_y - y;
        }

        return [ _x, _y ];
    }

    // return "realized" coordinates of a cell's neighbours.
    // the choice of local variable f sets the type of the world.
    function neighbours(x, y) {
        var f = universe_type;

        return [ f(x - 1, y - 1), f(x, y - 1), f(x + 1, y - 1),
                 f(x - 1, y),                  f(x + 1, y),
                 f(x - 1, y + 1), f(x, y + 1), f(x + 1, y + 1) ];
    }


    var __mem_existant_neighbours = {};
    function existant_neighbours(cell) {
        var cell_str = cell.toString();

        if (!__mem_existant_neighbours.hasOwnProperty(cell_str)) {
            var all = neighbours(cell[0], cell[1]);

            var ret = [];
            all.forEach(function (c) {
                if (c[0] >= 0 && c[0] < cellcount_x && c[1] >= 0 && c[1] < cellcount_y) {
                    ret.push(c);
                }
            });

            __mem_existant_neighbours[ cell_str ] = ret;
        }

        return __mem_existant_neighbours[ cell_str ];
    }

    function glider() {
        return [
            [2, 1],
            [3, 2],
            [1, 3], [2, 3], [3, 3]
        ];
    }

    function gosper_gun() {
        return [
            [25, 1],
            [23, 2], [25, 2],
            [13, 3], [14, 3], [21, 3], [22, 3], [35, 3], [36, 3],
            [12, 4], [16, 4], [21, 4], [22, 4], [35, 4], [36, 4],
            [1, 5], [2, 5], [11, 5], [17, 5], [21, 5], [22, 5],
            [1, 6], [2, 6], [11, 6], [15, 6], [17, 6], [18, 6], [23, 6], [25, 6],
            [11, 7], [17, 7], [25, 7],
            [12, 8], [16, 8],
            [13, 9], [14, 9]
        ];
    }

    function paint_initial_state(live_cells) {
        live_cells.forEach(function (cell) {
            setlive(cell);
            new_live.push(cell);
            inc_count_neigh(cell);
        });

        new_live.forEach(function (c) {
            may_die.push(c);
        });
        new_live = [];
    }


    function vivify(c) {
        if (isdead(c) && (neighbour_count_get(c) === 3)) {
            setlive(c);
            new_live.push(c);
        }
    }

    function kill(c) {
        var neigh_cn = neighbour_count_get(c);
        if (islive(c) &&
            (neigh_cn < 2 || neigh_cn > 3)) {
            setdead(c);
            new_die.push(c);
        }
    }

    function inc_count_neigh(c) {
        existant_neighbours(c).forEach(function (n) {
            var val = neighbour_count_get(n) + 1;
            neighbour_count_put(n, val);
            if (val === 3 && isdead(n)) may_live.push(n);
            if (val === 4 && islive(n)) may_die.push(n);
        });
    }

    function dec_count_neigh(c) {
        existant_neighbours(c).forEach(function (n) {
            var val = neighbour_count_get(n) - 1;
            neighbour_count_put(n, val);
            if (val === 3 && isdead(n)) may_live.push(n);
            if (val === 1 && islive(n)) may_die.push(n);
        });
    }

    function clocktick() {
        may_live.forEach(function (cell) { vivify(cell); });
        may_die.forEach( function (cell) { kill(cell);   });
        may_live = [];
        may_die = [];
        new_live.forEach(function (cell) { inc_count_neigh(cell); });
        new_die.forEach( function (cell) { dec_count_neigh(cell); });
        new_live = [];
        new_die = [];
    }

    $(document).ready(function () {
        // main
        universe_type = closed;
        create_structures();
        // single_glider(curstate);
        paint_initial_state(glider());

        setInterval(function () {
            clocktick();
        }, 650);
    });
})();
</script>
</body>
</html>
